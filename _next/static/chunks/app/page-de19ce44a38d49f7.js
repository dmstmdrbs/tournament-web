(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1946:(e,t,l)=>{Promise.resolve().then(l.bind(l,6175))},6175:(e,t,l)=>{"use strict";l.d(t,{default:()=>P});var a=l(5155),n=l(2115),s=l(5453),r=l(4532);let o=[4,8,16],i=(e,t)=>({roundIndex:e+1,matchIndex:Math.floor(t/2)}),d={getPlayers:async()=>{let e=localStorage.getItem("tournament_players");return e?JSON.parse(e):[]},savePlayers:async e=>{localStorage.setItem("tournament_players",JSON.stringify(e))},updatePlayer:async e=>{let t=(await d.getPlayers()).map(t=>t.id===e.id?e:t);await d.savePlayers(t)}},c=()=>d,m=(0,s.v)((e,t)=>({players:[],tournamentSize:8,rounds:[],isTournamentStarted:!1,winner:null,isPlayerSelectModalOpen:!1,targetMatchInfo:null,setTournamentSize:t=>e({tournamentSize:t}),addPlayer:t=>{if(!t.trim())return;let l={id:crypto.randomUUID(),name:t,wins:0};e((0,r.jM)(e=>{e.players.push(l)}))},removePlayer:t=>{e((0,r.jM)(e=>{e.players=e.players.filter(e=>e.id!==t)}))},startTournament:()=>{let{tournamentSize:l}=t(),a=Math.log2(l);if(a<1)return;let n=[];for(let e=0;e<a;e++){let t=l/Math.pow(2,e+1);n.push({title:0===e?"".concat(l,"강"):e===a-1?"결승":"".concat(2*t,"강"),seeds:Array(t).fill({}).map(()=>({id:crypto.randomUUID(),teams:[{name:"Player A"},{name:"Player B"}]}))})}e({rounds:n,isTournamentStarted:!0,winner:null})},resetTournament:()=>e({isTournamentStarted:!1,rounds:[],winner:null,isPlayerSelectModalOpen:!1,targetMatchInfo:null}),assignPlayersRandomly:()=>{let{players:l,tournamentSize:a,rounds:n}=t();if(l.length<a)return void alert("플레이어가 최소 ".concat(a,"명 필요합니다."));let s=[...l].sort(()=>.5-Math.random()).slice(0,a);e({rounds:(0,r.jM)(n,e=>{if(e.length>0){let t=0;e[0].seeds.forEach(e=>{e.teams[0]={...s[t]},t++,e.teams[1]={...s[t]},t++})}})})},assignPlayerToSlot:l=>{let{targetMatchInfo:a}=t();if(!a)return;let{roundIndex:n,matchIndex:s,teamIndex:o}=a;e((0,r.jM)(e=>{e.rounds[n].seeds[s].teams[o]={...l}})),t().closePlayerSelectModal()},setMatchWinner:(l,a,n)=>{let{rounds:s}=t();if(a===s.length-1){e({winner:l}),t().incrementWin(l.id);return}let o=i(a,n);e((0,r.jM)(e=>{e.rounds[a].seeds[n].winnerId=l.id;let t=e.rounds[o.roundIndex].seeds[o.matchIndex],s=n%2;t.teams[s]={...l}}))},openPlayerSelectModal:(t,l,a)=>{e({isPlayerSelectModalOpen:!0,targetMatchInfo:{roundIndex:t,matchIndex:l,teamIndex:a}})},closePlayerSelectModal:()=>{e({isPlayerSelectModalOpen:!1,targetMatchInfo:null})},incrementWin:t=>{let l=c();e((0,r.jM)(e=>{let a=e.players.find(e=>e.id===t);a&&(a.wins+=1,l.updatePlayer(a))}))}}));var x=l(7951);let u=e=>{let{winner:t,onReset:s}=e;return((0,n.useEffect)(()=>{t&&(async()=>{let e=(await l.e(585).then(l.bind(l,5585))).default,t=Date.now()+5e3,a={startVelocity:30,spread:360,ticks:60,zIndex:1e3},n=(e,t)=>Math.random()*(t-e)+e,s=setInterval(()=>{let l=t-Date.now();if(l<=0)return clearInterval(s);let r=l/5e3*50;e({...a,particleCount:r,origin:{x:n(.1,.3),y:Math.random()-.2}}),e({...a,particleCount:r,origin:{x:n(.7,.9),y:Math.random()-.2}})},250)})()},[t]),t)?(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex justify-center items-center z-50",children:(0,a.jsxs)("div",{className:"bg-gray-800 rounded-2xl shadow-2xl p-8 text-center border-2 border-yellow-400 transform scale-100 transition-transform duration-500",children:[(0,a.jsx)(x.A,{className:"w-24 h-24 mx-auto text-yellow-400 mb-4 animate-bounce"}),(0,a.jsx)("h2",{className:"text-4xl font-bold text-white mb-2",children:"최종 우승!"}),(0,a.jsx)("p",{className:"text-5xl font-extrabold text-yellow-300 mb-6",children:t.name}),(0,a.jsx)("button",{onClick:s,className:"mt-4 px-8 py-3 bg-indigo-600 text-white font-bold rounded-lg hover:bg-indigo-700 transition-colors shadow-lg",children:"새 토너먼트 시작하기"})]})}):null};var g=l(6985),h=l(4029);let y=e=>{let{seed:t,roundIndex:l,seedIndex:n}=e,s=m(e=>e.setMatchWinner),r=m(e=>e.openPlayerSelectModal),[o,i]=t.teams,d=(null==o?void 0:o.id)&&(null==i?void 0:i.id),c=e=>{d&&!t.winnerId&&s(e,l,n)},u=e=>{let{team:s,teamIndex:o}=e,i=t.winnerId&&s.id===t.winnerId,m=t.winnerId&&s.id!==t.winnerId,u=(null==s?void 0:s.name)||"...",g="\n      relative flex items-center justify-between w-full h-12 px-3 rounded-md cursor-pointer transition-all duration-300\n      ".concat(i?"bg-green-600 text-white font-bold":"","\n      ").concat(m?"bg-gray-600 text-gray-400 opacity-70":"","\n      ").concat(!t.winnerId&&s.id?"bg-gray-700 hover:bg-gray-600 text-white":"","\n      ").concat(s.id?"":"bg-gray-800 border-2 border-dashed border-gray-600 hover:border-indigo-500 hover:text-indigo-400 text-gray-500","\n    ");return(0,a.jsxs)("div",{"data-tooltip-id":"team-tooltip-".concat(s.id),"data-tooltip-content":s.name&&"(통산 ".concat(s.wins||0,"승)"),children:[(0,a.jsxs)("div",{className:g,onClick:()=>{s.id||r(l,n,o)},children:[(0,a.jsx)("span",{children:u}),d&&!t.winnerId&&(0,a.jsx)("button",{onClick:e=>{e.stopPropagation(),c(s)},className:"text-yellow-400 hover:text-yellow-300 z-10","aria-label":"".concat(s.name,"을(를) 승자로 지정"),children:(0,a.jsx)(x.A,{size:20})})]}),s.id&&(0,a.jsx)(h.m_,{id:"team-tooltip-".concat(s.id)})]})};return(0,a.jsxs)("div",{className:"flex flex-col gap-2 justify-center w-52 bg-gray-900/50 p-2 rounded-lg mb-16",children:[(0,a.jsx)(u,{team:o,teamIndex:0}),(0,a.jsx)("div",{className:"text-center text-gray-400 text-sm font-bold",children:"VS"}),(0,a.jsx)(u,{team:i,teamIndex:1})]})};var f=l(825);let p=()=>{let e=m(e=>e.rounds),t=m(e=>e.resetTournament),l=m(e=>e.assignPlayersRandomly),n=m(e=>e.players),s=m(e=>e.tournamentSize);if(0===e.length)return(0,a.jsx)("div",{className:"text-white text-center p-8",children:"토너먼트를 시작해주세요."});let r=n.length>=s;return(0,a.jsxs)("div",{className:"w-full h-full",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-center items-center gap-4 mb-6 p-4 bg-gray-800 rounded-xl shadow-lg",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-white",children:"대진표 설정"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("button",{onClick:l,disabled:!r,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-600 disabled:cursor-not-allowed","data-tooltip-id":"random-assign-tooltip","data-tooltip-content":r?"랜덤으로 플레이어를 배치합니다.":"플레이어가 최소 ".concat(s,"명 필요합니다."),children:[(0,a.jsx)(f.A,{size:18})," 랜덤 배치"]}),(0,a.jsx)("button",{onClick:t,className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white font-semibold rounded-lg hover:bg-red-700 transition-colors",children:"초기화"})]}),(0,a.jsx)(h.m_,{id:"random-assign-tooltip"})]}),(0,a.jsx)("div",{className:"flex-1 h-full",children:(0,a.jsx)("div",{className:"text-white bg-gray-900 p-4 sm:p-8 rounded-lg max-h-screen overflow-y-auto",children:(0,a.jsx)(g.dr,{rounds:e,renderSeedComponent:y,swipeableProps:{enableMouseEvents:!0,onSwiped:()=>{}},roundClassName:"!mr-12 !mb-12 sm:!mr-24",bracketClassName:"!min-w-[100%]"})})})]})};var b=l(2767);let w=()=>{let e=m(e=>e.tournamentSize),t=m(e=>e.setTournamentSize),l=m(e=>e.startTournament),n=m(e=>e.players);return(0,a.jsxs)("div",{className:"bg-gray-800 p-6 rounded-xl shadow-lg flex flex-col items-center gap-4",children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-white",children:"토너먼트 규모 선택"}),(0,a.jsx)("div",{className:"flex gap-3",children:o.map(l=>(0,a.jsxs)("button",{onClick:()=>t(l),className:"px-6 py-2 rounded-md font-semibold transition-all ".concat(e===l?"bg-indigo-600 text-white shadow-md":"bg-gray-700 text-gray-300 hover:bg-gray-600"),children:[l,"강"]},l))}),(0,a.jsxs)("button",{onClick:()=>{if(n.length<e)return void alert("플레이어가 최소 ".concat(e,"명 이상 필요합니다. 현재 ").concat(n.length,"명."));l()},disabled:n.length<e,className:"w-full mt-4 bg-green-600 text-white font-bold py-3 rounded-lg hover:bg-green-700 transition-colors disabled:bg-gray-600 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:["토너먼트 시작! ",(0,a.jsx)(b.A,{})]})]})};var j=l(7580),v=l(2525);let N=()=>{let[e,t]=(0,n.useState)(""),l=m(e=>e.players),s=m(e=>e.addPlayer),r=m(e=>e.removePlayer);return(0,a.jsxs)("div",{className:"w-full md:w-80 bg-gray-800 p-6 rounded-xl shadow-lg",children:[(0,a.jsxs)("h3",{className:"text-xl font-bold text-white mb-4 flex items-center",children:[(0,a.jsx)(j.A,{className:"mr-2"})," 참가 플레이어 목록"]}),(0,a.jsxs)("form",{onSubmit:l=>{l.preventDefault(),s(e),t("")},className:"flex gap-2 mb-4",children:[(0,a.jsx)("input",{type:"text",value:e,onChange:e=>t(e.target.value),placeholder:"플레이어 이름 입력",className:"flex-grow bg-gray-700 text-white rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500"}),(0,a.jsx)("button",{type:"submit",className:"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 transition-colors font-semibold",children:"추가"})]}),(0,a.jsxs)("ul",{className:"space-y-2 h-auto overflow-y-auto pr-2",children:[0===l.length&&(0,a.jsx)("p",{className:"text-gray-400 text-center py-4",children:"플레이어를 추가해주세요."}),l.map(e=>(0,a.jsxs)("li",{className:"flex justify-between items-center bg-gray-700 p-2 rounded-md",children:[(0,a.jsxs)("span",{className:"text-white font-medium",children:[e.name," ",(0,a.jsxs)("span",{className:"text-yellow-400 text-sm",children:["(",e.wins,"승)"]})]}),(0,a.jsx)("button",{onClick:()=>r(e.id),className:"text-gray-400 hover:text-red-500 transition-colors",children:(0,a.jsx)(v.A,{size:18})})]},e.id))]})]})};var S=l(4416);let M=()=>{let e=m(e=>e.isPlayerSelectModalOpen),t=m(e=>e.closePlayerSelectModal),l=m(e=>e.players),s=m(e=>e.rounds),r=(0,n.useMemo)(()=>new Set(s.flatMap(e=>e.seeds.flatMap(e=>e.teams.map(e=>e.id).filter(Boolean)))),[s]),o=m(e=>e.assignPlayerToSlot);return e?(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex justify-center items-center z-40",children:(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg shadow-xl p-6 w-full max-w-sm border border-gray-700",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-white",children:"플레이어 선택"}),(0,a.jsx)("button",{onClick:t,className:"text-gray-400 hover:text-white",children:(0,a.jsx)(S.A,{size:24})})]}),(0,a.jsx)("ul",{className:"space-y-2 max-h-80 overflow-y-auto",children:l.map(e=>{let t=r.has(e.id);return(0,a.jsx)("li",{children:(0,a.jsxs)("button",{onClick:()=>o(e),disabled:t,className:"w-full text-left p-3 rounded-md transition-colors ".concat(t?"bg-gray-700 text-gray-500 cursor-not-allowed":"bg-gray-600 text-white hover:bg-indigo-600"),children:[e.name," ",t&&"(배치됨)"]})},e.id)})})]})}):null},P=function(){let e=m(e=>e.players),t=m(e=>e.isTournamentStarted),l=m(e=>e.winner),s=m(e=>e.resetTournament);return(0,n.useEffect)(()=>{c().getPlayers().then(e=>{JSON.stringify(m.getState().players)!==JSON.stringify(e)&&m.setState({players:e})})},[]),(0,n.useEffect)(()=>{c().savePlayers(e)},[e]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u,{winner:l,onReset:s}),t?(0,a.jsx)(p,{}):(0,a.jsxs)("div",{className:"w-full max-w-4xl mx-auto flex flex-col md:flex-row gap-8 h-full",children:[(0,a.jsx)("div",{className:"flex-1 h-full",children:(0,a.jsx)(w,{})}),(0,a.jsx)("div",{className:"flex-1 h-full",children:(0,a.jsx)(N,{})})]}),(0,a.jsx)(M,{})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[112,441,684,358],()=>t(1946)),_N_E=e.O()}]);